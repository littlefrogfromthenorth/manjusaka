var I=Object.defineProperty,_=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var F=(e,a,t)=>a in e?I(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,D=(e,a)=>{for(var t in a||(a={}))y.call(a,t)&&F(e,t,a[t]);if(C)for(var t of C(a))K.call(a,t)&&F(e,t,a[t]);return e},g=(e,a)=>_(e,P(a));var B=(e,a,t)=>new Promise((i,r)=>{var c=n=>{try{u(t.next(n))}catch(o){r(o)}},s=n=>{try{u(t.throw(n))}catch(o){r(o)}},u=n=>n.done?i(n.value):Promise.resolve(n.value).then(c,s);u((t=t.apply(e,a)).next())});import{b as v,r as N,c as $,a as w,aQ as A,q as E,cj as f,aR as d,o as R,i as H,j as b,k as m,aT as x,f as G,e as L,z as M,m as X,bM as U,ck as V}from"./index.0bfc751b.js";import{S as q}from"./index.6b2df8cb.js";import{B as j,u as z}from"./useTable.88284727.js";import{B as S,u as O,T as W}from"./useForm.3c23bbf7.js";import{D as Q}from"./index.f24fabcf.js";import{B as J,u as Y,a as Z}from"./index.662e64ef.js";import"./index.242d16c8.js";import"./index.701d5ab5.js";import"./index.71b679cd.js";import"./useSize.df470e37.js";import"./useContentViewHeight.cc5ed19b.js";import"./ArrowLeftOutlined.b5c738ec.js";import"./index.314c218e.js";import"./FullscreenOutlined.44ecaf61.js";import"./_baseIteratee.ae4a1dda.js";import"./index.c66248c6.js";import"./isEqual.6389973c.js";import"./index.7dacf1f4.js";import"./index.2d06da9e.js";import"./useSortable.af8ffa94.js";import"./index.88ce77f7.js";import"./index.fac76bbd.js";import"./scrollTo.6e40734e.js";import"./index.a15e7a56.js";import"./download.ab84bb41.js";import"./index.70d43123.js";const ee=v({name:"RoleDrawer",components:{BasicDrawer:J,BasicForm:S},emits:["success","register"],setup(e,{emit:a}){const t=N(!0),i=[{field:"id",label:"\u76D1\u542C\u5668ID",component:"Input",componentProps:{disabled:!0}},{field:"transport",label:"\u534F\u8BAE",required:!0,component:"RadioButtonGroup",componentProps:{options:[{label:"TCP",value:"tcp"},{label:"KCP",value:"kcp"},{label:"WebSocket",value:"websocket"},{label:"Forward(tcp)",value:"forward"}]}},{field:"listenaddr",label:"\u76D1\u542C\u5730\u5740",required:!0,component:"Input",defaultValue:"0.0.0.0:32000"},{field:"onlineaddr",label:"\u4E0A\u7EBF\u5730\u5740",component:"Input",required:!0,componentProps:{placeholder:"127.0.0.1:32000"}},{field:"RTT",label:"RTT",component:"RadioButtonGroup",componentProps:{options:[{label:"KK",value:"KK"},{label:"NN",value:"NN"},{label:"XX",value:"XX"},{label:"NK",value:"NK"},{label:"NX",value:"NX"},{label:"IK",value:"IK"}]}},{field:"DH",label:"DH",component:"RadioButtonGroup",componentProps:{options:[{label:"25519",value:"25519"},{label:"448",value:"448"}]}},{field:"ENC",label:"ENC ",component:"RadioButtonGroup",componentProps:{options:[{label:"ChaChaPoly",value:"ChaChaPoly"},{label:"AESGCM",value:"AESGCM"}]}},{field:"HASH",label:"HASH ",component:"RadioButtonGroup",componentProps:{options:[{label:"BLAKE2s",value:"BLAKE2s"},{label:"BLAKE2b",value:"BLAKE2b"},{label:"SHA256",value:"SHA256"},{label:"SHA512",value:"SHA512"}]}},{field:"proxyaddr",label:"\u4EE3\u7406\u5730\u5740",component:"Input",componentProps:{placeholder:"(socks|http|https)://user:pass@127.0.0.1:8080"}},{field:"enckey",label:"\u52A0\u5BC6\u5BC6\u94A5",component:"Input",defaultValue:"manjusaka"}],[r,{resetFields:c,setFieldsValue:s,validate:u}]=O({labelWidth:90,schemas:i,showActionButtonGroup:!1}),[n,{setDrawerProps:o,closeDrawer:l}]=Y(p=>B(this,null,function*(){c(),o({confirmLoading:!1}),t.value=!!(p!=null&&p.isUpdate),w(t)?s(g(D({},p.record),{transport:p.record.transport||"tcp"})):s({transport:"tcp"})})),h=$(()=>w(t)?"\u7F16\u8F91":"\u65B0\u589E");function T(){return B(this,null,function*(){try{const p=yield u(),{createMessage:k}=E();o({confirmLoading:!0}),f({action:"listenupdate",data:p}).then(()=>{k.success("\u6210\u529F! \u8BF7\u5237\u65B0\u5217\u8868")}).catch(()=>{}).finally(()=>{a("success")}),l()}finally{o({confirmLoading:!1})}})}return{registerDrawer:n,registerForm:r,getTitle:h,handleSubmit:T}}});function te(e,a,t,i,r,c){const s=d("BasicForm"),u=d("BasicDrawer");return R(),H(u,x(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"800px",onOk:e.handleSubmit}),{default:b(()=>[m(s,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var oe=A(ee,[["render",te]]);const ae=v({name:"ListenManagement",components:{BasicTable:j,RoleDrawer:oe,TableAction:W,Description:Q,BasicForm:S},setup(){G({target:{}});const{createMessage:e}=E();L();const[a,{openDrawer:t}]=Z(),[i,{reload:r}]=z({title:"NPC2\u76D1\u542C\u5668",columns:[{title:"\u534F\u8BAE",dataIndex:"transport",width:120},{title:"\u76D1\u542C\u5730\u5740",dataIndex:"listenaddr"},{title:"\u4E0A\u7EBF\u5730\u5740",dataIndex:"onlineaddr"},{title:"\u5BC6\u94A5",dataIndex:"enckey"},{title:"\u52A0\u5BC6\u65B9\u5F0F",dataIndex:"noise"},{title:"\u72B6\u6001",dataIndex:"isrun",width:120,customRender:({record:o})=>U(q,{checked:o.isrun==!0,checkedChildren:"\u5DF2\u542F\u7528",unCheckedChildren:"\u5DF2\u7981\u7528",onChange(l){o.isrun=l,f({action:"listenaction",data:{id:o.id,isrun:o.isrun}}).then(()=>{o.isrun=l,e.success("\u5DF2\u6210\u529F\u4FEE\u6539\u76D1\u542C\u5668\u72B6\u6001")}).catch(()=>{}).finally(()=>{})}})},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updateat",width:100,customRender:({record:o})=>V(new Date(o.updateat*1e3))}],api:f,showTableSetting:!0,bordered:!0,showIndexColumn:!1,actionColumn:{width:150,title:"\u64CD\u4F5C",dataIndex:"action",slots:{customRender:"action"},fixed:void 0},beforeFetch:function(o){const{page:l,pageSize:h}=o;return{action:"listenlist",data:{page:l,size:h}}}});function c(){t(!0,{isUpdate:!1}),r()}function s(o){t(!0,{record:o,isUpdate:!0}),r()}function u(o){f({action:"listendelete",data:{id:o.id}}).then(()=>{e.success("\u5220\u9664\u6210\u529F")}).catch(()=>{}).finally(()=>{r()})}function n(){r()}return{registerTablelisten:i,registerDrawer:a,handleCreate:c,handleEdit:s,handleDelete:u,handleSuccess:n}}});function ne(e,a,t,i,r,c){const s=d("a-button"),u=d("TableAction"),n=d("BasicTable"),o=d("RoleDrawer");return R(),M("div",null,[m(n,{onRegister:e.registerTablelisten},{toolbar:b(()=>[m(s,{type:"primary",onClick:e.handleCreate},{default:b(()=>[...a[0]||(a[0]=[X(" \u65B0\u5EFA\u76D1\u542C\u5668 ",-1)])]),_:1},8,["onClick"])]),action:b(({record:l})=>[m(u,{actions:[{icon:"clarity:note-edit-line",label:"\u7F16\u8F91",onClick:e.handleEdit.bind(null,l)},{icon:"ant-design:delete-outlined",label:"\u5220\u9664",color:"error",popConfirm:{title:"\u662F\u5426\u786E\u8BA4\u5220\u9664",confirm:e.handleDelete.bind(null,l)}}]},null,8,["actions"])]),_:1},8,["onRegister"]),m(o,{onRegister:e.registerDrawer,onSuccess:e.handleSuccess},null,8,["onRegister","onSuccess"])])}var Pe=A(ae,[["render",ne]]);export{Pe as default};
