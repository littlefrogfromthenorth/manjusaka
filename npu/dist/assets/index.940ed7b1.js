var $=Object.defineProperty,D=Object.defineProperties;var E=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var F=(e,o,t)=>o in e?$(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,b=(e,o)=>{for(var t in o||(o={}))z.call(o,t)&&F(e,t,o[t]);if(M)for(var t of M(o))A.call(o,t)&&F(e,t,o[t]);return e},_=(e,o)=>D(e,E(o));var h=(e,o,t)=>new Promise((l,s)=>{var c=n=>{try{i(t.next(n))}catch(a){s(a)}},r=n=>{try{i(t.throw(n))}catch(a){s(a)}},i=n=>n.done?l(n.value):Promise.resolve(n.value).then(c,r);i((t=t.apply(e,o)).next())});import{B as x,u as P}from"./useTable.8f642a92.js";import{B as U,u as O,T as q}from"./useForm.a5b01752.js";import{b as T,r as R,c as L,a as B,aQ as I,cj as C,aR as p,o as w,i as N,j as g,k as f,aT as V,q as S,z as j,m as G,ck as Q}from"./index.59109d81.js";import{B as W,u as H,a as J}from"./index.abeaa45a.js";import"./index.7d1af758.js";import"./index.169a2f8c.js";import"./index.6af6e8ee.js";import"./useSize.f495344d.js";import"./useContentViewHeight.b742a811.js";import"./ArrowLeftOutlined.76351c5d.js";import"./index.5d8d8edd.js";import"./FullscreenOutlined.e9ba2b3a.js";import"./_baseIteratee.2ac5361a.js";import"./index.b51e258d.js";import"./index.3b17542c.js";import"./isEqual.442fc559.js";import"./index.ef80d76f.js";import"./useSortable.98c26055.js";import"./index.24c08581.js";import"./index.9a88e72b.js";import"./scrollTo.66a1ba12.js";import"./index.f2a8f060.js";import"./download.60714c4e.js";const K=T({name:"RoleModal",components:{BasicModal:W,BasicForm:U},emits:["success","register"],setup(e,{emit:o}){const t=R(!0),l=R(""),{createMessage:s}=S(),[c,{setFieldsValue:r,updateSchema:i,resetFields:n,validate:a}]=O({labelWidth:100,schemas:[{field:"id",label:"ID",component:"Input",componentProps:{disabled:!0}},{field:"username",label:"\u7528\u6237\u540D",required:!0,component:"Input"},{field:"password",label:"\u5BC6\u7801",required:!0,component:"Input"},{field:"passfrom",label:"\u5BC6\u7801\u6765\u6E90",component:"Input"},{field:"passtype",label:"\u7C7B\u578B",component:"Input"}],showActionButtonGroup:!1,actionColOptions:{span:23}}),[d,{setModalProps:m,closeModal:k}]=H(u=>h(this,null,function*(){n(),m({confirmLoading:!1}),t.value=!!(u!=null&&u.isUpdate),B(t)&&(l.value=u.record.id,r(b({},u.record)))})),v=L(()=>B(t)?"\u7F16\u8F91":"\u65B0\u589E");function y(){return h(this,null,function*(){try{const u=yield a();m({confirmLoading:!0}),C({action:"passupdate",data:u}).then(()=>{s.success("\u6210\u529F!")}).catch(()=>{}).finally(()=>{}),k(),o("success",{isUpdate:B(t),values:_(b({},u),{id:l.value})})}finally{m({confirmLoading:!1})}})}return{registerModal:d,registerForm:c,getTitle:v,handleSubmit:y}}});function X(e,o,t,l,s,c){const r=p("BasicForm"),i=p("BasicModal");return w(),N(i,V(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:g(()=>[f(r,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var Y=I(K,[["render",X]]);const Z=T({name:"RoleManagement",components:{BasicTable:x,RoleModal:Y,TableAction:q},setup(){const{createMessage:e}=S(),[o,{openModal:t}]=J(),[l,{reload:s}]=P({title:"\u5BC6\u7801\u6536\u96C6\u7ED3\u679C",columns:[{title:"NPC",dataIndex:"agent"},{title:"\u7528\u6237\u540D",dataIndex:"username",align:"right"},{title:"\u5BC6\u7801",dataIndex:"password",align:"left"},{title:"\u6765\u6E90",dataIndex:"passfrom"},{title:"\u7C7B\u578B",dataIndex:"passtype",align:"right",width:120},{title:"\u65F6\u95F4",dataIndex:"updateat",width:120,customRender:({record:a})=>Q(new Date(a.updateat*1e3))}],showTableSetting:!0,bordered:!0,showIndexColumn:!1,size:"small",clickToRowSelect:!1,actionColumn:{width:150,title:"\u64CD\u4F5C",dataIndex:"action",slots:{customRender:"action"},fixed:void 0},api:C,pagination:{pageSizeOptions:[100,200,500,1e3],pageSize:100},beforeFetch:function(a){const{page:d,pageSize:m}=a;return{action:"passlist",data:{page:d,size:m}}}});function c(){t(!0,{isUpdate:!1}),s()}function r(a){t(!0,{record:a,isUpdate:!0}),s()}function i(a){C({action:"passdelete",data:{id:a.id}}).then(()=>{e.success("\u5220\u9664\u6210\u529F")}).catch(()=>{}).finally(()=>{s()})}function n(){s()}return{registerTablepassret:l,registerModal:o,handleCreate:c,handleEdit:r,handleDelete:i,handleSuccess:n}}});function ee(e,o,t,l,s,c){const r=p("a-button"),i=p("TableAction"),n=p("BasicTable"),a=p("RoleModal");return w(),j("div",null,[f(n,{onRegister:e.registerTablepassret},{toolbar:g(()=>[f(r,{type:"primary",onClick:e.handleCreate},{default:g(()=>[...o[0]||(o[0]=[G(" \u65B0\u589E ",-1)])]),_:1},8,["onClick"])]),action:g(({record:d})=>[f(i,{actions:[{icon:"clarity:note-edit-line",label:"\u7F16\u8F91",onClick:e.handleEdit.bind(null,d)},{icon:"ant-design:delete-outlined",color:"error",label:"\u5220\u9664",popConfirm:{title:"\u786E\u8BA4\u5220\u9664?",confirm:e.handleDelete.bind(null,d)}}]},null,8,["actions"])]),_:1},8,["onRegister"]),f(a,{onRegister:e.registerModal,onSuccess:e.handleSuccess},null,8,["onRegister","onSuccess"])])}var Ie=I(Z,[["render",ee]]);export{Ie as default};
